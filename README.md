# **项目需求**

1. 将dict.txt的数据导入到**数据库**中保存
2. 登录注册功能，不能重复登录，重复注册
3. 单词查询功能
4. 历史记录功能，存储单词，意思，以及查询时间
5. 基于**TCP**，支持多客户端连接
6. 采用数据库保存用户信息与历史记录
7. 按下ctrl+c退出客户端后，注销该客户端的登录信息

# 项目逻辑

<img src="./电子词典.png" style="zoom:80%;" />

# 通信协议

- 用户注册：发送数据第一位为**0**，后跟用户名**`usr`**或**`passwd`**字符串数据，以**0**结尾。

​		如果注册成功返回**1**，注册失败返回**0**。

- 用户登录：发送数据第一位为**1**，后跟用户名**`usrname`**和**`passwd`**字符串数据，中间以数字**0**分割，最后以**0**结尾。

- 用户上传单词：发送数据格式为**2、单词数据、0**。

- 服务器发送单词和翻译：数据格式为**单词、0、翻译、0**，如果单词不存在，则发送**0**。

- 

  

# 函数模块

#### 客户端：

- 用户注册**do_register**：向服务先发送账号数据，如果没有重复账号收到**1**，然后输入密码，如果密码不合法要重新输入。

  如遇重复账号收到**0**，需要输入新的账号。

- 用户登录**do_login**：向服务器发送账号密码数据，如果其中有任何一个数据出错则收到**0**。

- 用户搜索单词**do_translate**：向服务发送单词数据，搜索成功返回单词和意思，打印单词和意思，失败则返回**0**。

- 用户查询历史**do_history**：向服务发送请求，如果没有历史记录收到**0**并打印提示，否则打印所有历史记录。

  

#### 服务端：

- 处理用户注册**do_register**：接受用户的**username**数据，使用sql语句判断是否有重名，没有重名继续接受密码数据，然后在、存入数据库中；如果有重名发送**0**然后重新等待**username**数据。
- 处理用户登录**do_login**：同时接受账号和密码数据，使用sql语句查找是否有相同数据，有发送**1**，没有发送**0**。
- 处理用户单词**do_translate**：接受用户的完整单词数据，在数据库中查找，如果查找成功发送单词和意思，如果有多个意思先把翻译拼接在一起然后发送；如果查找失败发送**0**。然后把搜索历史插入数据库中。
- 查询用户历史**do_history**：根据用户的账号查询历史，将所有历史数据拼接在一起发送；没有发送**0**。









